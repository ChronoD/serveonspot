(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{172:function(t,n,e){},173:function(t,n,e){},340:function(t,n,e){"use strict";e.r(n);var i=e(0),r=e.n(i),o=e(24),s=e.n(o),a=(e(172),e(173),e(61)),c=e(347),p=e(42),u=e(165),l=e(70),d=e(36),j=e(52),f={customerMode:!0,authenticationHeader:void 0,userInfo:void 0},m=Object(j.b)({name:"app",initialState:f,reducers:{toggleAppointmentMode:function(t){t.customerMode=!t.customerMode}}}),g=m.actions.toggleAppointmentMode,b=m.reducer,h=d.c,O={gettingSpecialists:!1,gettingSpecialistsError:void 0,specialists:void 0,postingAppointment:!1,appointmentError:void 0,appointmentInfo:void 0,unregisteringAppointment:!1,unregisteringAppointmentError:void 0},A=Object(j.b)({name:"customer",initialState:O,reducers:{gettingSpecialists:function(t){t.gettingSpecialists=!0},specialistsSuccess:function(t,n){t.gettingSpecialists=!1,t.specialists=n.payload},specialistsError:function(t,n){t.gettingSpecialists=!1,t.appointmentError=n.payload},postingAppointment:function(t){t.postingAppointment=!0},postingAppointmentSuccess:function(t,n){t.postingAppointment=!1,t.appointmentInfo=n.payload},postingAppointmentError:function(t,n){t.postingAppointment=!1,t.appointmentError=n.payload},unregistering:function(t){t.unregisteringAppointment=!0},unregisteringSuccess:function(t){t.appointmentInfo=void 0,t.unregisteringAppointment=!1,t.unregisteringAppointmentError=void 0},unregisteringError:function(t,n){t.unregisteringAppointment=!1,t.unregisteringAppointmentError=n.payload},resetCustomerState:function(t){return O}}}),x=A.actions,v=(x.postingAppointment,x.postingAppointmentSuccess),E=x.postingAppointmentError,S=(x.gettingSpecialists,x.specialistsSuccess),I=x.specialistsError,y=(x.unregistering,x.unregisteringSuccess),C=x.unregisteringError,T=x.resetCustomerState,w=A.reducer,k=e(48),F=e(344),D=e(6);function H(t){var n=t.appointmentInfo,e=t.unregisterAppointment,i=t.unregistering,r=t.returnToMenu,o=(n.positionOnTheList,n.message),s=n.specialist,a=n.status,c=n.approximateTimeLeft;return Object(D.jsx)(D.Fragment,{children:Object(D.jsxs)(F.a,{title:"".concat(s.specialistInfo),style:{width:300,border:"STARTED"===a?"5px solid green":"5px solid yellow"},children:[Object(D.jsxs)(D.Fragment,{children:["Informacija:",Object(D.jsx)("p",{children:o}),Object(D.jsx)("p",{children:c})]}),"FINISHED"!==a&&Object(D.jsx)(u.a,{type:"primary",disabled:"REGISTERED"!==a,onClick:e,loading:i,children:"At\u0161aukti"}),"FINISHED"===a&&Object(D.jsx)(u.a,{type:"primary",onClick:r,children:"Atgal"})]})})}var R=e(343);function L(t){var n=t.registerAppointment,e=t.registering,i=(t.registeringError,t.specialists);return Object(D.jsxs)("div",{children:[i?Object(D.jsx)(D.Fragment,{children:i.length&&Object(D.jsxs)(D.Fragment,{children:[Object(D.jsx)("div",{children:"Dirbantys specialistai:"}),Object(D.jsx)(R.b,{itemLayout:"vertical",size:"large",dataSource:i,renderItem:function(t){return Object(D.jsx)(R.b.Item,{children:Object(D.jsx)(F.a,{title:t.specialistInfo,style:{border:"5px solid green"},children:Object(D.jsx)(u.a,{type:"primary",onClick:function(){return n(t.specialistId)},loading:e,children:"Registruotis"})})})}})]})}):"Laukiama duomen\u0173",0===i.length&&"\u0160iuo metu n\u0117ra dirban\u010di\u0173 specialist\u0173"]})}function N(t){Object(a.a)(t);var n=h((function(t){return t.customer})),e=n.gettingSpecialists,r=n.gettingSpecialistsError,o=n.specialists,s=n.postingAppointment,c=n.appointmentError,p=n.appointmentInfo,u=n.unregisteringAppointment,l=n.unregisteringAppointmentError,j=Object(d.b)();function f(t){j(v(t)),g()}var m=null;function g(){m&&m.close()}Object(i.useEffect)((function(){return p?g():(m=Object(k.c)((function(t){return j(S(t))}),(function(t){return j(I(t))}))).addEventListener("close",(function(){var t;return null===(t=m)||void 0===t?void 0:t.close()})),function(){g()}}),[p]);var b=null;return Object(i.useEffect)((function(){if(p)return b=Object(k.d)(p.appointmentId,f),function(){b&&b.close()}}),[p]),Object(D.jsxs)("div",{children:[o&&!p&&Object(D.jsx)(L,{registerAppointment:function(t){Object(k.e)(t,(function(t){return j(v(t))}),(function(t){return j(E(t))}))},registering:s,registeringError:c,loadingSpecialists:e,loadingSpecialistsError:r,specialists:o}),p&&Object(D.jsx)(H,{appointmentInfo:p,unregisterAppointment:function(){return t=p.appointmentId,void Object(k.f)(t,(function(){return j(y())}),(function(t){return j(C(t))}));var t},unregistering:u,unregisteringError:l,returnToMenu:function(){return j(T())}})]})}function M(t){var n=t.userInfo,e=t.appointments,i=(t.appointmentsError,t.startAppointment),r=t.endAppointment,o=t.cancelAppointment,s=t.updating,a=(t.updatingError,"ADMIN"===n.authority);return Object(D.jsxs)(D.Fragment,{children:[Object(D.jsx)(l.a,{children:Object(D.jsx)(p.a,{span:12,offset:6,children:n&&!e?"Laukiama vizit\u0173 duomen\u0173":"Vizitai"})}),void 0!==e&&Object(D.jsx)(l.a,{justify:"center",children:Object(D.jsx)(R.b,{itemLayout:"horizontal",dataSource:e,locale:{emptyText:"\u0160iuo metu prisiregistravusi\u0173 n\u0117ra."},renderItem:function(t){return Object(D.jsx)(R.b.Item,{children:Object(D.jsx)(F.a,{bodyStyle:{display:a?"none":void 0},style:{width:300,border:"STARTED"===t.status?"5px solid green":"5px solid yellow"},title:"".concat(t.appointmentId,": ").concat("REGISTERED"===t.status?"laukia":"vyksta"),extra:!a&&Object(D.jsx)(u.a,{onClick:function(){return o(t.appointmentId)},loading:s,size:"small",children:"at\u0161aukti"}),children:!a&&Object(D.jsxs)(D.Fragment,{children:[Object(D.jsx)(u.a,{disabled:"STARTED"===t.status,onClick:function(){return i(t.appointmentId)},loading:s,children:"prad\u0117ti"}),Object(D.jsx)(u.a,{disabled:"STARTED"!==t.status,onClick:function(){return r(t.appointmentId)},loading:s,children:"baigti"})]})})})}})})]})}var z=e(80),P=e(345),B=e(346),J={labelCol:{span:8},wrapperCol:{span:16}},G={wrapperCol:{offset:8,span:16}};function V(t){var n=t.onSubmit;return Object(D.jsx)(l.a,{children:Object(D.jsxs)(P.a,Object(z.a)(Object(z.a)({},J),{},{name:"basic",initialValues:{remember:!0},onFinish:n,children:[Object(D.jsx)(P.a.Item,{label:"Vartotojas",name:"username",rules:[{required:!0,message:"Vartotojo vardas b\u016btinas!"}],children:Object(D.jsx)(B.a,{})}),Object(D.jsx)(P.a.Item,{label:"Slapta\u017eodis",name:"password",rules:[{required:!0,message:"Slapta\u017eodis b\u016btinas!"}],children:Object(D.jsx)(B.a.Password,{})}),Object(D.jsx)(P.a.Item,Object(z.a)(Object(z.a)({},G),{},{children:Object(D.jsx)(u.a,{type:"primary",htmlType:"submit",children:"Prisijungti"})}))]}))})}function U(t){var n=t.userInfo,e=t.logout;return Object(D.jsx)(D.Fragment,{children:Object(D.jsx)(l.a,{children:Object(D.jsxs)(p.a,{span:6,offset:16,children:[Object(D.jsx)(l.a,{justify:"end",children:Object(D.jsx)(u.a,{onClick:e,children:"Atsijungti"})}),Object(D.jsx)(l.a,{justify:"end",children:Object(D.jsx)("div",{children:"Prisijunges kaip:"})}),Object(D.jsx)(l.a,{justify:"end",align:"middle",children:Object(D.jsx)("div",{children:null!==n.specialist?n.specialist.specialistInfo:n.authority})})]})})})}var q={authenticationHeader:void 0,userInfo:void 0,updatingAppointment:!1,updatingAppointmentError:void 0,updatedAppointment:void 0,appointments:void 0,appointmentsError:void 0},K=Object(j.b)({name:"staff",initialState:q,reducers:{setAppointments:function(t,n){t.appointments=n.payload,t.appointmentsError=void 0},setAppointmentsError:function(t,n){t.appointments=void 0,t.appointmentsError=n.payload},updateAppointment:function(t){t.updatingAppointment=!0},updateAppointmentError:function(t,n){t.updatingAppointment=!1,t.updatingAppointmentError=n.payload},updateAppointmentSuccess:function(t,n){t.updatingAppointment=!1,t.updatedAppointment=n.payload},setUserInfoAndAuthenticationHeader:function(t,n){var e=n.payload,i=e.userInfo,r=e.header;t.userInfo=i,t.authenticationHeader=r},resetStaffState:function(t){return q}}}),Q=K.actions,W=Q.setAppointments,X=(Q.setAppointmentsError,Q.setUserInfoAndAuthenticationHeader),Y=Q.resetStaffState,Z=(Q.updateAppointment,Q.updateAppointmentError),$=Q.updateAppointmentSuccess,_=function(t){return t.staff.authenticationHeader},tt=K.reducer;function nt(t){Object(a.a)(t);var n=!!Object(d.c)(_),e=h((function(t){return t.staff})),r=e.authenticationHeader,o=e.userInfo,s=e.updatingAppointment,c=(e.updatingAppointmentError,e.updatedAppointment,e.appointments),u=e.appointmentsError,l=Object(d.b)(),j=function(t,n){return l(X({userInfo:t,header:n}))},f=function(t){return function(n){Object(k.g)(n,t,r||"",(function(t){return l($(t))}),(function(t){return l(Z(t))}))}};var m=null;return Object(i.useEffect)((function(){return o&&(m=Object(k.b)((function(t){return l(W(t))}),r)),function(){console.log("closing appmt"),m&&m.close()}}),[o]),Object(D.jsxs)(D.Fragment,{children:[!n&&Object(D.jsx)(V,{onSubmit:function(t){Object(k.a)(t,j)}}),n&&Object(D.jsxs)(p.a,{span:24,children:[Object(D.jsx)(p.a,{span:24,children:o&&Object(D.jsx)(U,{userInfo:o,logout:function(){l(Y())}})}),o&&Object(D.jsx)(M,{userInfo:o,appointments:c,appointmentsError:u,startAppointment:f("STARTED"),endAppointment:f("FINISHED"),cancelAppointment:f("CANCELLED"),updating:s,updatingError:u})]})]})}var et=e(101);function it(t){Object(a.a)(t);var n=h((function(t){return t})),e=n.app.customerMode,i=n.customer.appointmentInfo,r=n.staff.userInfo,o=Object(d.b)();return Object(D.jsxs)(c.a,{children:[Object(D.jsx)(et.Header,{}),Object(D.jsxs)(et.Content,{style:{minHeight:"30rem"},children:[Object(D.jsx)(p.a,{span:24,offset:18,children:!i&&!r&&Object(D.jsx)(u.a,{onClick:function(){o(g())},children:e?"Darbuotojams":"Gr\u012f\u017eti"})}),Object(D.jsxs)(l.a,{justify:"center",align:"middle",children:[!e&&Object(D.jsx)(nt,{}),e&&Object(D.jsx)(N,{})]})]}),Object(D.jsx)(et.Footer,{children:"Serve-On-Spot App, 2021"})]})}var rt=e(162),ot=Object(j.a)({reducer:{app:b,customer:w,staff:tt},middleware:function(t){return t({serializableCheck:!1})}});var st=function(){return Object(D.jsx)("div",{className:"App",children:Object(D.jsx)(rt.ErrorBoundary,{FallbackComponent:function(){return Object(D.jsx)("p",{children:"whoops"})},children:Object(D.jsx)(d.a,{store:ot,children:Object(D.jsx)(it,{})})})})},at=function(t){t&&t instanceof Function&&e.e(3).then(e.bind(null,348)).then((function(n){var e=n.getCLS,i=n.getFID,r=n.getFCP,o=n.getLCP,s=n.getTTFB;e(t),i(t),r(t),o(t),s(t)}))};s.a.render(Object(D.jsx)(r.a.StrictMode,{children:Object(D.jsx)(st,{})}),document.getElementById("root")),at()},48:function(t,n,e){"use strict";(function(t){e.d(n,"c",(function(){return s})),e.d(n,"e",(function(){return a})),e.d(n,"d",(function(){return c})),e.d(n,"f",(function(){return p})),e.d(n,"a",(function(){return u})),e.d(n,"b",(function(){return l})),e.d(n,"g",(function(){return d}));var i=e(79),r=e.n(i),o=e(154);function s(t,n){var e=new EventSource("http://127.0.0.1:8080/specialists");return e.onerror=function(){n(new Error("Nepavyko gauti specialist\u0173")),2===e.readyState&&setTimeout(s,300)},e.onmessage=function(n){var e=JSON.parse(n.data);console.log(e),t(e)},e}function a(t,n,e){return r.a.post("http://localhost:8080/appointments",{specialistId:t},{headers:{"Access-Control-Allow-Origin":"*"}}).then((function(t){var e=t.data;n(e)})).catch((function(t){e(t)}))}function c(t,n){var e=new EventSource("http://127.0.0.1:8080/appointments/".concat(t));return e.onerror=function(){2===e.readyState&&setTimeout(c,300)},e.onmessage=function(t){var e=JSON.parse(t.data);console.log("appointment",e),n(e)},e}function p(t,n,e){return r.a.patch("http://localhost:8080/appointments/".concat(t),{status:"UNREGISTERED"},{headers:{"Access-Control-Allow-Origin":"*"}}).then((function(t){n()})).catch((function(t){e(t)}))}function u(n,e){var i=function(n){var e=n.username,i=n.password,r=e+":"+i;return"Basic "+t.from(r).toString("base64")}(n);return console.log(i),r.a.get("http://localhost:8080/user",{headers:{"Access-Control-Allow-Origin":"*",authorization:i}}).then((function(t){var n=t.data;console.log(n),e(n,i)})).catch((function(t){console.log(t)}))}function l(t,n){var e=new o.EventSourcePolyfill("http://127.0.0.1:8080/appointments",{headers:{"Access-Control-Allow-Origin":"*",authorization:"".concat(n)}});return e.onerror=function(){2===e.readyState&&setTimeout(l,300)},e.onmessage=function(n){var e=JSON.parse(n.data);t(e)},e}function d(t,n,e,i,o){return r.a.patch("http://localhost:8080/appointments/".concat(t),{status:n},{headers:{authorization:"".concat(e),"Access-Control-Allow-Origin":"http://localhost:3000"}}).then((function(t){i(t.data)})).catch((function(t){o(t)}))}}).call(this,e(181).Buffer)}},[[340,1,2]]]);
//# sourceMappingURL=main.1af6c935.chunk.js.map