(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{137:function(t,n,e){},138:function(t,n,e){},242:function(t,n,e){"use strict";e.r(n);var i=e(0),r=e.n(i),o=e(26),c=e.n(o),s=(e(137),e(138),e(39)),a=e(128),u=e(27),p=e(45),l={customerMode:!0,authenticationHeader:void 0,userInfo:void 0},d=Object(p.b)({name:"app",initialState:l,reducers:{toggleAppointmentMode:function(t){t.customerMode=!t.customerMode}}}),f=d.actions.toggleAppointmentMode,j=d.reducer,g=u.c,m={gettingSpecialists:!1,gettingSpecialistsError:void 0,specialists:void 0,postingAppointment:!1,appointmentError:void 0,appointmentInfo:void 0,unregisteringAppointment:!1,unregisteringAppointmentError:void 0},b=Object(p.b)({name:"customer",initialState:m,reducers:{gettingSpecialists:function(t){t.gettingSpecialists=!0},specialistsSuccess:function(t,n){t.gettingSpecialists=!1,t.specialists=n.payload},specialistsError:function(t,n){t.gettingSpecialists=!1,t.appointmentError=n.payload},postingAppointment:function(t){t.postingAppointment=!0},postingAppointmentSuccess:function(t,n){t.postingAppointment=!1,t.appointmentInfo=n.payload},postingAppointmentError:function(t,n){t.postingAppointment=!1,t.appointmentError=n.payload},unregistering:function(t){t.unregisteringAppointment=!0},unregisteringSuccess:function(t){t.appointmentInfo=void 0,t.unregisteringAppointment=!1,t.unregisteringAppointmentError=void 0},unregisteringError:function(t,n){t.unregisteringAppointment=!1,t.unregisteringAppointmentError=n.payload}}}),h=b.actions,O=(h.postingAppointment,h.postingAppointmentSuccess),v=h.postingAppointmentError,x=(h.gettingSpecialists,h.specialistsSuccess),A=h.specialistsError,S=(h.unregistering,h.unregisteringSuccess),I=h.unregisteringError,E=b.reducer,y=e(36),w=e(6);function C(t){var n=t.appointmentInfo,e=t.unregisterAppointment,i=t.unregistering,r=n.appointmentId,o=n.message,c=n.specialist;return Object(w.jsxs)("div",{children:[Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("div",{children:"Vizitas:"}),"Nr. ".concat(r," pas ").concat(c.specialistInfo)]}),Object(w.jsx)("div",{children:Object(w.jsxs)(w.Fragment,{children:["Informacija:",Object(w.jsx)("p",{children:o}),Object(w.jsx)(a.a,{onClick:e,loading:i,children:"at\u0161aukti"})]})})]})}var k=e(246),F=e(247);function H(t){var n=t.registerAppointment,e=t.registering,i=(t.registeringError,t.specialists);return Object(w.jsxs)("div",{children:[i?Object(w.jsx)(w.Fragment,{children:i.length&&Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("div",{children:"Dirbantys specialistai:"}),Object(w.jsx)(k.b,{itemLayout:"vertical",size:"large",dataSource:i,renderItem:function(t){return Object(w.jsx)(k.b.Item,{children:Object(w.jsxs)(F.a,{title:t.specialistId,style:{border:"5px solid green"},children:[Object(w.jsx)(w.Fragment,{children:t.specialistType}),Object(w.jsxs)(a.a,{onClick:function(){return n(t.specialistId)},loading:e,children:["Registruotis ",t.specialistId]})]})})}})]})}):"Laukiama duomen\u0173",0===i.length&&"\u0160iuo metu n\u0117ra dirban\u010di\u0173 specialist\u0173"]})}function z(t){Object(s.a)(t);var n=g((function(t){return t.customer})),e=n.gettingSpecialists,r=n.gettingSpecialistsError,o=n.specialists,c=n.postingAppointment,a=n.appointmentError,p=n.appointmentInfo,l=n.unregisteringAppointment,d=n.unregisteringAppointmentError,f=Object(u.b)();function j(t){f(O(t)),b()}var m=null;function b(){console.log("closing specialists"),m&&m.close()}function h(){console.log("closing appointments"),E&&E.close()}Object(i.useEffect)((function(){return p?b():(m=Object(y.d)((function(t){return f(x(t))}),(function(t){return f(A(t))}))).addEventListener("close",(function(){var t;return null===(t=m)||void 0===t?void 0:t.close()})),function(){b()}}),[p]);var E=null;return Object(i.useEffect)((function(){if(p)return E=Object(y.e)(p.appointmentId,j),function(){h()}}),[p]),Object(i.useEffect)((function(){return function(){h(),b()}}),[p]),Object(w.jsxs)("div",{children:[o&&!p&&Object(w.jsx)(H,{registerAppointment:function(t){Object(y.f)(t,(function(t){return f(O(t))}),(function(t){return f(v(t))}))},registering:c,registeringError:a,loadingSpecialists:e,loadingSpecialistsError:r,specialists:o}),p&&Object(w.jsx)(C,{appointmentInfo:p,unregisterAppointment:function(){return t=p.appointmentId,void Object(y.g)(t,(function(){return f(S())}),(function(t){return f(I(t))}));var t},unregistering:l,unregisteringError:d})]})}var M=e(129);function T(t){Object(s.a)(t);var n=g((function(t){return t.staff})).authenticationHeader,e=Object(i.useState)(void 0),r=Object(M.a)(e,2),o=r[0],c=r[1];function a(t){return c(t)}return console.log(o),Object(i.useEffect)((function(){var t=Object(y.c)(a,n);return function(){console.log("closing appmt"),t.close()}}),[]),Object(w.jsx)("div",{children:o?Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("div",{children:"Vizitai:"}),o.length&&o.map((function(t){return Object(w.jsx)("div",{children:Object(w.jsx)("p",{children:"".concat(t.appointmentId," ").concat(t.started?"vyksta":"laukia"," ")},t.appointmentId)},t.appointmentId)}))]}):"Laukiama duomen\u0173"})}var L=e(64),N=e(245),B=e(248),J={labelCol:{span:8},wrapperCol:{span:16}},P={wrapperCol:{offset:8,span:16}};function V(t){var n=t.onSubmit;return Object(w.jsxs)(N.a,Object(L.a)(Object(L.a)({},J),{},{name:"basic",initialValues:{remember:!0},onFinish:n,children:[Object(w.jsx)(N.a.Item,{label:"Vartotojo vardas",name:"username",rules:[{required:!0,message:"Vartotojo vardas b\u016btinas!"}],children:Object(w.jsx)(B.a,{})}),Object(w.jsx)(N.a.Item,{label:"Slapta\u017eodis",name:"password",rules:[{required:!0,message:"Slapta\u017eodis b\u016btinas!"}],children:Object(w.jsx)(B.a.Password,{})}),Object(w.jsx)(N.a.Item,Object(L.a)(Object(L.a)({},P),{},{children:Object(w.jsx)(a.a,{type:"primary",htmlType:"submit",children:"Prisijungti"})}))]}))}var q={authenticationHeader:void 0,userInfo:void 0},U=Object(p.b)({name:"staff",initialState:q,reducers:{postAppointment:function(t){},setUserInfoAndAuthenticationHeader:function(t,n){var e=n.payload,i=e.userInfo,r=e.header;t.authenticationHeader=r,t.userInfo=i},unsetUserInfoAndAuthenticationHeader:function(t,n){t.authenticationHeader=void 0,t.userInfo=void 0}}}),D=U.actions,G=D.setUserInfoAndAuthenticationHeader,R=D.unsetUserInfoAndAuthenticationHeader,K=function(t){return t.staff.authenticationHeader},Q=U.reducer;function W(t){Object(s.a)(t);var n=Object(u.b)();return Object(w.jsx)(a.a,{onClick:function(){n(R()),Object(y.b)()},children:"Atsijungti"})}function X(t){Object(s.a)(t);var n=!!Object(u.c)(K),e=Object(u.b)(),i=function(t,n){return e(G({userInfo:t,header:n}))};return Object(w.jsxs)("div",{children:[!n&&Object(w.jsx)(V,{onSubmit:function(t){Object(y.a)(t,i)}}),n&&Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(T,{}),Object(w.jsx)(W,{})]})]})}function Y(t){Object(s.a)(t);var n=g((function(t){return t})),e=n.app.customerMode,i=n.customer.appointmentInfo,r=Object(u.b)();return Object(w.jsxs)("div",{children:[!i&&Object(w.jsx)(a.a,{type:"primary",onClick:function(){r(f())},children:e?"Darbuotojams":"Gr\u012f\u017eti"}),!e&&Object(w.jsx)(X,{}),e&&Object(w.jsx)(z,{})]})}var Z=e(125),$=Object(p.a)({reducer:{app:j,customer:E,staff:Q},middleware:function(t){return t({serializableCheck:!1})}});var _=function(){return Object(w.jsx)("div",{className:"App",children:Object(w.jsx)(Z.ErrorBoundary,{FallbackComponent:function(){return Object(w.jsx)("p",{children:"whoops"})},children:Object(w.jsx)(u.a,{store:$,children:Object(w.jsx)(Y,{})})})})},tt=function(t){t&&t instanceof Function&&e.e(3).then(e.bind(null,249)).then((function(n){var e=n.getCLS,i=n.getFID,r=n.getFCP,o=n.getLCP,c=n.getTTFB;e(t),i(t),r(t),o(t),c(t)}))};c.a.render(Object(w.jsx)(r.a.StrictMode,{children:Object(w.jsx)(_,{})}),document.getElementById("root")),tt()},36:function(t,n,e){"use strict";(function(t){e.d(n,"f",(function(){return c})),e.d(n,"e",(function(){return s})),e.d(n,"g",(function(){return a})),e.d(n,"a",(function(){return u})),e.d(n,"c",(function(){return p})),e.d(n,"d",(function(){return l})),e.d(n,"b",(function(){return d}));var i=e(59),r=e.n(i),o=e(116);function c(t,n,e){return r.a.post("http://localhost:8080/appointments",{specialistId:t},{headers:{"Access-Control-Allow-Origin":"*"}}).then((function(t){var e=t.data;n(e)})).catch((function(t){e(t)}))}function s(t,n){var e=new EventSource("http://127.0.0.1:8080/appointments/".concat(t));return e.onerror=function(){2===e.readyState&&setTimeout(s,300)},e.onmessage=function(t){console.log("appointment",t);var e=JSON.parse(t.data);n(e)},e}function a(t,n,e){return r.a.patch("http://localhost:8080/appointments/".concat(t),{status:"unregister"},{headers:{"Access-Control-Allow-Origin":"*"}}).then((function(t){n()})).catch((function(t){e(t)}))}function u(n,e){var i=function(n){var e=n.username,i=n.password,r=e+":"+i;return"Basic "+t.from(r).toString("base64")}(n);return r.a.get("http://localhost:8080/user",{headers:{"Access-Control-Allow-Origin":"*",authorization:i}}).then((function(t){var n,o=t.data;console.log(o),e(o[0],i),n=i,r.a.interceptors.request.use((function(t){return t.headers.authorization=n,t}))})).catch((function(t){console.log(t)}))}function p(t,n){var e=new o.EventSourcePolyfill("http://127.0.0.1:8080/appointments",{headers:{"Access-Control-Allow-Origin":"*",authorization:"".concat(n)}});return e.onerror=function(){2===e.readyState&&setTimeout(p,300)},e.onmessage=function(n){var e=JSON.parse(n.data);t(e)},e}function l(t,n){var e=new EventSource("http://127.0.0.1:8080/specialists");return e.onerror=function(){n(new Error("Nepavyko gauti specialist\u0173")),2===e.readyState&&setTimeout(l,300)},e.onmessage=function(n){var e=JSON.parse(n.data);t(e)},e}function d(){r.a.interceptors.request.use((function(t){return t.headers.authorization=null,t}))}}).call(this,e(146).Buffer)}},[[242,1,2]]]);
//# sourceMappingURL=main.3124b117.chunk.js.map