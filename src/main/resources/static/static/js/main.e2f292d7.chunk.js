(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{172:function(t,n,e){},173:function(t,n,e){},340:function(t,n,e){"use strict";e.r(n);var i=e(0),r=e.n(i),o=e(24),s=e.n(o),a=(e(172),e(173),e(62)),c=e(347),u=e(42),p=e(165),l=e(71),d=e(36),f=e(52),j={customerMode:!0,authenticationHeader:void 0,userInfo:void 0},m=Object(f.b)({name:"app",initialState:j,reducers:{toggleAppointmentMode:function(t){t.customerMode=!t.customerMode}}}),g=m.actions.toggleAppointmentMode,b=m.reducer,h=d.c,O={gettingSpecialists:!1,gettingSpecialistsError:void 0,specialists:void 0,postingAppointment:!1,appointmentError:void 0,appointmentInfo:void 0,unregisteringAppointment:!1,unregisteringAppointmentError:void 0},A=Object(f.b)({name:"customer",initialState:O,reducers:{gettingSpecialists:function(t){t.gettingSpecialists=!0},specialistsSuccess:function(t,n){t.gettingSpecialists=!1,t.specialists=n.payload},specialistsError:function(t,n){t.gettingSpecialists=!1,t.appointmentError=n.payload},postingAppointment:function(t){t.postingAppointment=!0},postingAppointmentSuccess:function(t,n){t.postingAppointment=!1,t.appointmentInfo=n.payload},postingAppointmentError:function(t,n){t.postingAppointment=!1,t.appointmentError=n.payload},unregistering:function(t){t.unregisteringAppointment=!0},unregisteringSuccess:function(t){t.appointmentInfo=void 0,t.unregisteringAppointment=!1,t.unregisteringAppointmentError=void 0},unregisteringError:function(t,n){t.unregisteringAppointment=!1,t.unregisteringAppointmentError=n.payload}}}),x=A.actions,v=(x.postingAppointment,x.postingAppointmentSuccess),E=x.postingAppointmentError,S=(x.gettingSpecialists,x.specialistsSuccess),I=x.specialistsError,y=(x.unregistering,x.unregisteringSuccess),C=x.unregisteringError,w=A.reducer,T=e(46),k=e(344),F=e(6);function D(t){var n=t.appointmentInfo,e=t.unregisterAppointment,i=t.unregistering,r=n.positionOnTheList,o=n.message,s=n.specialist,a=n.status,c=n.approximateTimeLeft;return Object(F.jsx)(F.Fragment,{children:Object(F.jsxs)(k.a,{title:"Nr. ".concat(r," pas ").concat(s.specialistInfo),style:{width:300,border:"STARTED"===a?"5px solid green":"5px solid yellow"},children:[Object(F.jsxs)(F.Fragment,{children:["Informacija:",Object(F.jsx)("p",{children:o}),Object(F.jsx)("p",{children:c})]}),Object(F.jsx)(p.a,{type:"primary",onClick:e,loading:i,children:"At\u0161aukti"})]})})}var L=e(343);function z(t){var n=t.registerAppointment,e=t.registering,i=(t.registeringError,t.specialists);return Object(F.jsxs)("div",{children:[i?Object(F.jsx)(F.Fragment,{children:i.length&&Object(F.jsxs)(F.Fragment,{children:[Object(F.jsx)("div",{children:"Dirbantys specialistai:"}),Object(F.jsx)(L.b,{itemLayout:"vertical",size:"large",dataSource:i,renderItem:function(t){return Object(F.jsx)(L.b.Item,{children:Object(F.jsx)(k.a,{title:t.specialistInfo,style:{border:"5px solid green"},children:Object(F.jsx)(p.a,{type:"primary",onClick:function(){return n(t.specialistId)},loading:e,children:"Registruotis"})})})}})]})}):"Laukiama duomen\u0173",0===i.length&&"\u0160iuo metu n\u0117ra dirban\u010di\u0173 specialist\u0173"]})}function H(t){Object(a.a)(t);var n=h((function(t){return t.customer})),e=n.gettingSpecialists,r=n.gettingSpecialistsError,o=n.specialists,s=n.postingAppointment,c=n.appointmentError,u=n.appointmentInfo,p=n.unregisteringAppointment,l=n.unregisteringAppointmentError,f=Object(d.b)();function j(t){f(v(t)),g()}var m=null;function g(){m&&m.close()}Object(i.useEffect)((function(){return u?g():(m=Object(T.d)((function(t){return f(S(t))}),(function(t){return f(I(t))}))).addEventListener("close",(function(){var t;return null===(t=m)||void 0===t?void 0:t.close()})),function(){g()}}),[u]);var b=null;return Object(i.useEffect)((function(){if(u)return b=Object(T.e)(u.appointmentId,j),function(){b&&b.close()}}),[u]),Object(F.jsxs)("div",{children:[o&&!u&&Object(F.jsx)(z,{registerAppointment:function(t){Object(T.f)(t,(function(t){return f(v(t))}),(function(t){return f(E(t))}))},registering:s,registeringError:c,loadingSpecialists:e,loadingSpecialistsError:r,specialists:o}),u&&Object(F.jsx)(D,{appointmentInfo:u,unregisterAppointment:function(){return t=u.appointmentId,void Object(T.g)(t,(function(){return f(y())}),(function(t){return f(C(t))}));var t},unregistering:p,unregisteringError:l})]})}function R(t){var n=t.userInfo,e=t.appointments,i=(t.appointmentsError,t.startAppointment),r=t.endAppointment,o=t.cancelAppointment,s=t.updating;t.updatingError;return Object(F.jsx)(F.Fragment,{children:Object(F.jsxs)(l.a,{justify:"center",children:[n&&!e&&Object(F.jsx)(F.Fragment,{children:' "Laukiama vizit\u0173 duomen\u0173"'}),Object(F.jsx)(u.a,{span:12,children:"Vizitai:"}),Object(F.jsx)(l.a,{justify:"center",children:Object(F.jsx)(L.b,{itemLayout:"horizontal",dataSource:e,locale:{emptyText:"\u0160iuo metu prisiregistravusi\u0173 n\u0117ra."},renderItem:function(t){return Object(F.jsx)(L.b.Item,{children:Object(F.jsxs)(k.a,{style:{width:300,border:"STARTED"===t.status?"5px solid green":"5px solid yellow"},title:"".concat(t.appointmentId,": ").concat("REGISTERED"===t.status?"laukia":"vyksta"),extra:Object(F.jsx)(p.a,{onClick:function(){return o(t.appointmentId)},loading:s,size:"small",children:"at\u0161aukti"}),children:[Object(F.jsx)(p.a,{disabled:"STARTED"===t.status,onClick:function(){return i(t.appointmentId)},loading:s,children:"prad\u0117ti"}),Object(F.jsx)(p.a,{disabled:"STARTED"!==t.status,onClick:function(){return r(t.appointmentId)},loading:s,children:"baigti"})]})})}})})]})})}var N=e(80),M=e(345),P=e(346),B={labelCol:{span:8},wrapperCol:{span:16}},J={wrapperCol:{offset:8,span:16}};function q(t){var n=t.onSubmit;return Object(F.jsxs)(M.a,Object(N.a)(Object(N.a)({},B),{},{name:"basic",initialValues:{remember:!0},onFinish:n,children:[Object(F.jsx)(M.a.Item,{label:"Vartotojo vardas",name:"username",rules:[{required:!0,message:"Vartotojo vardas b\u016btinas!"}],children:Object(F.jsx)(P.a,{})}),Object(F.jsx)(M.a.Item,{label:"Slapta\u017eodis",name:"password",rules:[{required:!0,message:"Slapta\u017eodis b\u016btinas!"}],children:Object(F.jsx)(P.a.Password,{})}),Object(F.jsx)(M.a.Item,Object(N.a)(Object(N.a)({},J),{},{children:Object(F.jsx)(p.a,{type:"primary",htmlType:"submit",children:"Prisijungti"})}))]}))}function V(t){var n=t.userInfo,e=t.logout;return Object(F.jsx)(F.Fragment,{children:Object(F.jsx)(l.a,{children:Object(F.jsxs)(u.a,{span:6,offset:16,children:[Object(F.jsx)(l.a,{justify:"end",children:Object(F.jsx)("div",{children:"Prisijunges kaip:"})}),Object(F.jsx)(l.a,{justify:"end",align:"middle",children:Object(F.jsx)("div",{children:null!==n.specialist?n.specialist.specialistInfo:n.authority})}),Object(F.jsx)(l.a,{justify:"end",children:Object(F.jsx)(p.a,{onClick:e,children:"Atsijungti"})})]})})})}var G={authenticationHeader:void 0,userInfo:void 0,updatingAppointment:!1,updatingAppointmentError:void 0,updatedAppointment:void 0,appointments:void 0,appointmentsError:void 0},U=Object(f.b)({name:"staff",initialState:G,reducers:{setAppointments:function(t,n){t.appointments=n.payload,t.appointmentsError=void 0},setAppointmentsError:function(t,n){t.appointments=void 0,t.appointmentsError=n.payload},updateAppointment:function(t){t.updatingAppointment=!0},updateAppointmentError:function(t,n){t.updatingAppointment=!1,t.updatingAppointmentError=n.payload},updateAppointmentSuccess:function(t,n){t.updatingAppointment=!1,t.updatedAppointment=n.payload},setUserInfoAndAuthenticationHeader:function(t,n){var e=n.payload,i=e.userInfo,r=e.header;t.userInfo=i,t.authenticationHeader=r},resetStaffState:function(t){return G}}}),K=U.actions,Q=K.setAppointments,W=(K.setAppointmentsError,K.setUserInfoAndAuthenticationHeader),X=K.resetStaffState,Y=(K.updateAppointment,K.updateAppointmentError),Z=K.updateAppointmentSuccess,$=function(t){return t.staff.authenticationHeader},_=U.reducer;function tt(t){Object(a.a)(t);var n=!!Object(d.c)($),e=h((function(t){return t.staff})),r=e.authenticationHeader,o=e.userInfo,s=e.updatingAppointment,c=(e.updatingAppointmentError,e.updatedAppointment,e.appointments),u=e.appointmentsError,p=Object(d.b)(),f=function(t,n){return p(W({userInfo:t,header:n}))},j=function(t){return function(n){Object(T.h)(n,t,(function(t){return p(Z(t))}),(function(t){return p(Y(t))}))}};var m=null;return Object(i.useEffect)((function(){return o&&(m=Object(T.c)((function(t){return p(Q(t))}),r)),function(){console.log("closing appmt"),m&&m.close()}}),[o]),Object(F.jsxs)("div",{children:[Object(F.jsx)(l.a,{justify:"center",children:!n&&Object(F.jsx)(q,{onSubmit:function(t){Object(T.a)(t,f)}})}),n&&Object(F.jsxs)(l.a,{justify:"center",children:[o&&Object(F.jsx)(V,{userInfo:o,logout:function(){Object(T.b)(),p(X())}}),o&&Object(F.jsx)(R,{userInfo:o,appointments:c,appointmentsError:u,startAppointment:j("STARTED"),endAppointment:j("FINISHED"),cancelAppointment:j("CANCELLED"),updating:s,updatingError:u})]})]})}var nt=e(101);function et(t){Object(a.a)(t);var n=h((function(t){return t})),e=n.app.customerMode,i=n.customer.appointmentInfo,r=n.staff.userInfo,o=Object(d.b)();return Object(F.jsxs)(c.a,{children:[Object(F.jsx)(nt.Header,{}),Object(F.jsxs)(nt.Content,{style:{minHeight:"30rem"},children:[Object(F.jsx)(u.a,{span:24,offset:16,children:!i&&!r&&Object(F.jsx)(p.a,{onClick:function(){o(g())},children:e?"Darbuotojams":"Gr\u012f\u017eti"})}),Object(F.jsxs)(l.a,{justify:"center",align:"middle",children:[!e&&Object(F.jsx)(tt,{}),e&&Object(F.jsx)(H,{})]})]}),Object(F.jsx)(nt.Footer,{children:"Serve-On-Spot App, 2021"})]})}var it=e(162),rt=Object(f.a)({reducer:{app:b,customer:w,staff:_},middleware:function(t){return t({serializableCheck:!1})}});var ot=function(){return Object(F.jsx)("div",{className:"App",children:Object(F.jsx)(it.ErrorBoundary,{FallbackComponent:function(){return Object(F.jsx)("p",{children:"whoops"})},children:Object(F.jsx)(d.a,{store:rt,children:Object(F.jsx)(et,{})})})})},st=function(t){t&&t instanceof Function&&e.e(3).then(e.bind(null,348)).then((function(n){var e=n.getCLS,i=n.getFID,r=n.getFCP,o=n.getLCP,s=n.getTTFB;e(t),i(t),r(t),o(t),s(t)}))};s.a.render(Object(F.jsx)(r.a.StrictMode,{children:Object(F.jsx)(ot,{})}),document.getElementById("root")),st()},46:function(t,n,e){"use strict";(function(t){e.d(n,"f",(function(){return s})),e.d(n,"e",(function(){return a})),e.d(n,"g",(function(){return c})),e.d(n,"h",(function(){return u})),e.d(n,"a",(function(){return p})),e.d(n,"c",(function(){return l})),e.d(n,"d",(function(){return d})),e.d(n,"b",(function(){return f}));var i=e(59),r=e.n(i),o=e(154);function s(t,n,e){return r.a.post("http://localhost:8080/appointments",{specialistId:t},{headers:{"Access-Control-Allow-Origin":"*"}}).then((function(t){var e=t.data;n(e)})).catch((function(t){e(t)}))}function a(t,n){var e=new EventSource("http://127.0.0.1:8080/appointments/".concat(t));return e.onerror=function(){2===e.readyState&&setTimeout(a,300)},e.onmessage=function(t){console.log("appointment",t);var e=JSON.parse(t.data);n(e)},e}function c(t,n,e){return r.a.patch("http://localhost:8080/appointments/".concat(t),{status:"UNREGISTERED"},{headers:{"Access-Control-Allow-Origin":"*"}}).then((function(t){n()})).catch((function(t){e(t)}))}function u(t,n,e,i){return r.a.patch("http://localhost:8080/appointments/".concat(t),{status:n},{headers:{"Access-Control-Allow-Origin":"*"}}).then((function(t){e(t.data)})).catch((function(t){i(t)}))}function p(n,e){console.log(n.username);var i=function(n){var e=n.username,i=n.password,r=e+":"+i;return"Basic "+t.from(r).toString("base64")}(n);return console.log(i),r.a.get("http://localhost:8080/user",{headers:{"Access-Control-Allow-Origin":"*",authorization:i}}).then((function(t){var n,o=t.data;console.log(o),e(o,i),n=i,r.a.interceptors.request.use((function(t){return t.headers.authorization=n,t}))})).catch((function(t){console.log(t)}))}function l(t,n){var e=new o.EventSourcePolyfill("http://127.0.0.1:8080/appointments",{headers:{"Access-Control-Allow-Origin":"*",authorization:"".concat(n)}});return e.onerror=function(){2===e.readyState&&setTimeout(l,300)},e.onmessage=function(n){var e=JSON.parse(n.data);t(e)},e}function d(t,n){var e=new EventSource("http://127.0.0.1:8080/specialists");return e.onerror=function(){n(new Error("Nepavyko gauti specialist\u0173")),2===e.readyState&&setTimeout(d,300)},e.onmessage=function(n){var e=JSON.parse(n.data);t(e)},e}function f(){r.a.interceptors.request.use((function(t){return t.headers.authorization=null,t}))}}).call(this,e(181).Buffer)}},[[340,1,2]]]);
//# sourceMappingURL=main.e2f292d7.chunk.js.map