(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{125:function(t,e,n){"use strict";(function(t){function r(e){var n=e.username+":"+e.password;return"Basic "+t.from(n).toString("base64")}n.d(e,"a",(function(){return r}))}).call(this,n(334).Buffer)},184:function(t,e,n){},185:function(t,e,n){},338:function(t,e,n){"use strict";n.r(e);var r=n(0),i=n.n(r),o=n(24),a=n.n(o),s=(n(184),n(185),n(95)),c=n(346),p=n(45),u=n(176),l=n(72),d=n(42),f=n(39),j=Object(f.c)({name:"mainPanel",initialState:{customerMode:!0},reducers:{toggleCustomerMode:function(t){t.customerMode=!t.customerMode}}}),g=j.actions.toggleCustomerMode,m=j.reducer,b=d.c,h=n(50),O=n.n(h),x=n(70),v={gettingSpecialists:!1,gettingSpecialistsError:void 0,specialists:void 0,postingAppointment:!1,appointmentError:void 0,appointmentInfo:void 0,unregisteringAppointment:!1,unregisteringAppointmentError:void 0},E=Object(f.b)("customer/register",(function(t){return A.apply(this,arguments)}));function A(){return(A=Object(x.a)(O.a.mark((function t(e){var n,r;return O.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("http://localhost:8080/appointments",{method:"POST",headers:{"Access-Control-Allow-Origin":"*","Content-Type":"application/json"},body:JSON.stringify({specialistId:e})});case 2:return n=t.sent,t.next=5,n.json();case 5:return r=t.sent,t.abrupt("return",r);case 7:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var y=Object(f.b)("customer/unregisterAppointment",(function(t){return I.apply(this,arguments)}));function I(){return(I=Object(x.a)(O.a.mark((function t(e){var n,r;return O.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("http://localhost:8080/appointments/".concat(e),{method:"PATCH",headers:{"Access-Control-Allow-Origin":"*","Content-Type":"application/json"},body:JSON.stringify({status:"UNREGISTERED"})});case 2:return n=t.sent,t.next=5,n.json();case 5:return r=t.sent,t.abrupt("return",r);case 7:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var S=Object(f.c)({name:"customer",initialState:v,reducers:{gettingSpecialists:function(t){t.gettingSpecialists=!0},specialistsSuccess:function(t,e){t.gettingSpecialists=!1,t.specialists=e.payload},specialistsError:function(t,e){t.gettingSpecialists=!1,t.appointmentError=e.payload},resetRegisteringError:function(t){t.appointmentError=void 0},watchAppointmentSuccess:function(t,e){t.appointmentInfo=e.payload},watchAppointmentError:function(t,e){t.appointmentError=e.payload},resetUnregisteringError:function(t){t.unregisteringAppointmentError=void 0},resetCustomerState:function(t){return v}},extraReducers:function(t){t.addCase(E.pending,(function(t){t.postingAppointment=!0})),t.addCase(E.fulfilled,(function(t,e){t.postingAppointment=!1,t.appointmentInfo=e.payload,t.appointmentError=void 0})),t.addCase(E.rejected,(function(t,e){t.postingAppointment=!1,t.appointmentError=e.error?new Error(e.error.message):void 0})),t.addCase(y.pending,(function(t){t.unregisteringAppointment=!0})),t.addCase(y.fulfilled,(function(t,e){t.appointmentInfo=e.payload,t.unregisteringAppointment=!1,t.unregisteringAppointmentError=void 0})),t.addCase(y.rejected,(function(t,e){t.unregisteringAppointment=!1,t.unregisteringAppointmentError=e.error?new Error(e.error.message):void 0}))}}),C=S.actions,w=(C.gettingSpecialists,C.specialistsSuccess),k=C.specialistsError,T=C.resetRegisteringError,R=C.watchAppointmentSuccess,F=(C.watchAppointmentError,C.resetUnregisteringError),D=C.resetCustomerState,L=S.reducer,N=n(167);function U(t,e){var n=new EventSource("http://127.0.0.1:8080/specialists");return n.onerror=function(){e(new Error("Nepavyko gauti specialist\u0173 duomen\u0173")),2===n.readyState&&setTimeout(U,300)},n.onmessage=function(e){var n=JSON.parse(e.data);console.log(n),t(n)},n}function P(t,e){var n=new EventSource("http://127.0.0.1:8080/appointments/".concat(t));return n.onerror=function(){2===n.readyState&&setTimeout(P,300)},n.onmessage=function(t){var n=JSON.parse(t.data);console.log("appointment",n),e(n)},n}function z(t,e,n){var r=new N.EventSourcePolyfill("http://127.0.0.1:8080/appointments",{headers:{"Access-Control-Allow-Origin":"*",authorization:t}});return r.onerror=function(){if(2===r.readyState)return setTimeout(z,300),n(new Error("Nepavyko gauti vizit\u0173 duomen\u0173"))},r.onmessage=function(t){var n=JSON.parse(t.data);e(n)},r}var H=n(343),M=n(48),J=n.n(M),G=n(6);function V(t){var e=t.appointmentInfo,n=t.unregisterAppointment,r=t.unregistering,i=t.unregisteringError,o=t.closeUnregisteringError,a=t.returnToMenu,s=(e.positionOnTheList,e.message),c=e.specialist,p=e.status,l=e.approximateTimeLeft;return Object(G.jsxs)(G.Fragment,{children:[Object(G.jsx)(J.a,{visible:!!i,onCancel:o,footer:null,children:Object(G.jsx)("p",{children:"\u012evyko klaida, pabandykite v\u0117liau"})}),Object(G.jsxs)(H.a,{title:"".concat(c.specialistInfo),style:{width:300,border:"STARTED"===p?"5px solid green":"5px solid yellow"},children:[Object(G.jsxs)(G.Fragment,{children:["Informacija:",Object(G.jsx)("p",{children:s}),Object(G.jsx)("p",{children:l})]}),"REGISTERED"===p&&Object(G.jsx)(u.a,{type:"primary",onClick:n,loading:r,children:"At\u0161aukti"}),("UNREGISTERED"===p||"FINISHED"===p||"CANCELLED"===p)&&Object(G.jsx)(u.a,{type:"primary",onClick:a,children:"Atgal"})]})]})}var B=n(342);function q(t){var e=t.registerAppointment,n=t.registering,r=t.registeringError,i=t.closeRegisteringError,o=t.specialists;return Object(G.jsxs)("div",{children:[Object(G.jsx)(J.a,{visible:!!r,onCancel:i,footer:null,children:Object(G.jsx)("p",{children:"\u012evyko klaida, pabandykite v\u0117liau"})}),Object(G.jsx)(G.Fragment,{children:o.length&&Object(G.jsxs)(G.Fragment,{children:[Object(G.jsx)("div",{children:"Specialistai:"}),Object(G.jsx)(B.b,{itemLayout:"vertical",size:"large",dataSource:o,renderItem:function(t){return Object(G.jsx)(B.b.Item,{children:Object(G.jsx)(H.a,{title:t.specialistInfo,style:{border:"5px solid green"},children:Object(G.jsx)(u.a,{type:"primary",onClick:function(){return e(t.specialistId)},loading:n,children:"Registruotis"})})})}})]})}),0===o.length&&"\u0160iuo metu n\u0117ra dirban\u010di\u0173 specialist\u0173"]})}function W(){var t=b((function(t){return t.customer})),e=t.gettingSpecialists,n=t.gettingSpecialistsError,i=t.specialists,o=t.postingAppointment,a=t.appointmentError,s=t.appointmentInfo,c=t.unregisteringAppointment,u=t.unregisteringAppointmentError,f=Object(d.b)();function j(t){f(w(t))}function g(t){f(k(t))}function m(t){f(R(t))}var h=null;Object(r.useEffect)((function(){return s?h&&h.close():h=U(j,g),function(){h&&h.close()}}),[s]);var O=null;return Object(r.useEffect)((function(){if(s)return O=P(s.appointmentId,m),function(){O&&O.close()}}),[s]),Object(G.jsxs)("div",{children:[!i&&Object(G.jsx)(l.a,{children:Object(G.jsx)(p.a,{span:12,offset:6,children:"Laukiama specialist\u0173 duomen\u0173"})}),i&&!s&&Object(G.jsx)(q,{registerAppointment:function(t){f(E(t))},registering:o,registeringError:a,closeRegisteringError:function(){f(T())},loadingSpecialists:e,loadingSpecialistsError:n,specialists:i}),s&&Object(G.jsx)(V,{appointmentInfo:s,unregisterAppointment:function(){return t=s.appointmentId,void f(y(t));var t},unregistering:c,unregisteringError:u,closeUnregisteringError:function(){f(F())},returnToMenu:function(){f(D())}})]})}function K(t){var e=t.userInfo,n=t.appointments,r=t.appointmentsError,i=t.startAppointment,o=t.endAppointment,a=t.cancelAppointment,s=t.updating,c=t.updatingError,d=t.closeUpdatingError,f="ADMIN"===e.authority;return Object(G.jsxs)(G.Fragment,{children:[Object(G.jsx)(J.a,{visible:!!c,onCancel:d,footer:null,children:Object(G.jsx)("p",{children:"\u012evyko klaida, bandykite v\u0117liau"})}),Object(G.jsxs)(l.a,{children:[r&&Object(G.jsx)(p.a,{span:12,offset:6,children:"Klaida gaunant vizit\u0173 duomenis, palaukite"}),!r&&Object(G.jsx)(p.a,{span:12,offset:6,children:e&&!n?"Laukiama vizit\u0173 duomen\u0173":"Vizitai"})]}),void 0!==n&&Object(G.jsx)(l.a,{justify:"center",children:Object(G.jsx)(B.b,{itemLayout:"horizontal",dataSource:n,locale:{emptyText:"\u0160iuo metu prisiregistravusi\u0173 n\u0117ra."},renderItem:function(t){return Object(G.jsx)(B.b.Item,{children:Object(G.jsx)(H.a,{bodyStyle:{display:f?"none":void 0},style:{width:300,border:"STARTED"===t.status?"5px solid green":"5px solid yellow"},title:"".concat(t.appointmentId,": ").concat("REGISTERED"===t.status?"laukia":"vyksta"),extra:!f&&Object(G.jsx)(u.a,{onClick:function(){return a(t.appointmentId)},loading:s,size:"small",children:"at\u0161aukti"}),children:!f&&Object(G.jsxs)(G.Fragment,{children:[Object(G.jsx)(u.a,{disabled:"STARTED"===t.status,onClick:function(){return i(t.appointmentId)},loading:s,children:"prad\u0117ti"}),Object(G.jsx)(u.a,{disabled:"STARTED"!==t.status,onClick:function(){return o(t.appointmentId)},loading:s,children:"baigti"})]})})})}})})]})}var Q=n(83),X=n(344),Y=n(345),Z={labelCol:{span:8},wrapperCol:{span:16}},$={wrapperCol:{offset:8,span:16}};function _(t){var e=t.onSubmit,n=t.loginError,r=t.closeLoginError;return Object(G.jsxs)(l.a,{children:[Object(G.jsx)(J.a,{visible:!!n,onCancel:r,footer:null,children:Object(G.jsx)("p",{children:"Prisijungti nepavyko"})}),Object(G.jsxs)(X.a,Object(Q.a)(Object(Q.a)({},Z),{},{name:"basic",initialValues:{remember:!0},onFinish:e,children:[Object(G.jsx)(X.a.Item,{label:"Vartotojas",name:"username",rules:[{required:!0,message:"Vartotojo vardas b\u016btinas!"}],children:Object(G.jsx)(Y.a,{})}),Object(G.jsx)(X.a.Item,{label:"Slapta\u017eodis",name:"password",rules:[{required:!0,message:"Slapta\u017eodis b\u016btinas!"}],children:Object(G.jsx)(Y.a.Password,{})}),Object(G.jsx)(X.a.Item,Object(Q.a)(Object(Q.a)({},$),{},{children:Object(G.jsx)(u.a,{type:"primary",htmlType:"submit",children:"Prisijungti"})}))]}))]})}function tt(t){var e=t.userInfo,n=t.logout;return Object(G.jsx)(G.Fragment,{children:Object(G.jsx)(l.a,{children:Object(G.jsxs)(p.a,{span:6,offset:16,children:[Object(G.jsx)(l.a,{justify:"end",children:Object(G.jsx)(u.a,{onClick:n,children:"Atsijungti"})}),Object(G.jsx)(l.a,{justify:"end",children:Object(G.jsx)("div",{children:"Prisijunges kaip:"})}),Object(G.jsx)(l.a,{justify:"end",align:"middle",children:Object(G.jsx)("div",{children:null!==e.specialist?e.specialist.specialistInfo:e.authority})})]})})})}var et=n(125),nt={gettingUserInfo:!1,userInfo:void 0,authHeader:void 0,userInfoError:void 0,updatingAppointment:!1,updatingAppointmentError:void 0,updatedAppointment:void 0,appointments:void 0,appointmentsError:void 0},rt=Object(f.b)("staff/login",function(){var t=Object(x.a)(O.a.mark((function t(e,n){var r,i,o;return O.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=Object(et.a)(e),t.next=3,fetch("http://localhost:8080/user",{method:"GET",headers:{authorization:r,"Access-Control-Allow-Origin":"*"}});case 3:return i=t.sent,t.next=6,i.json();case 6:if(o=t.sent,400!==i.status&&401!==i.status&&500!==i.status){t.next=13;break}return t.t0=n,t.next=11,i.json();case 11:return t.t1=t.sent,t.abrupt("return",t.t0.rejectWithValue.call(t.t0,t.t1));case 13:return t.abrupt("return",o);case 14:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()),it=Object(f.b)("staff/updateAppointment",function(){var t=Object(x.a)(O.a.mark((function t(e,n){var r,i;return O.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("http://localhost:8080/appointments/".concat(e.appointmentId),{method:"PATCH",headers:{authorization:"".concat(n.getState().staff.authHeader),"Access-Control-Allow-Origin":"*","Content-Type":"application/json"},body:JSON.stringify({status:e.status})});case 2:if(400!==(r=t.sent).status&&401!==r.status&&500!==r.status){t.next=9;break}return t.t0=n,t.next=7,r.json();case 7:return t.t1=t.sent,t.abrupt("return",t.t0.rejectWithValue.call(t.t0,t.t1));case 9:return t.next=11,r.json();case 11:return i=t.sent,t.abrupt("return",i);case 13:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()),ot=Object(f.c)({name:"staff",initialState:nt,reducers:{setStaffAppointments:function(t,e){t.appointments=e.payload,t.appointmentsError=void 0},setAppointmentsError:function(t,e){console.log(e),t.appointments=void 0,t.appointmentsError=e.payload},resetLoginError:function(t){t.userInfoError=void 0},resetUpdatingError:function(t){t.updatingAppointmentError=void 0},logout:function(t){return nt}},extraReducers:function(t){t.addCase(rt.pending,(function(t){t.gettingUserInfo=!0})),t.addCase(rt.fulfilled,(function(t,e){t.gettingUserInfo=!1,t.userInfo=e.payload,t.userInfoError=void 0,t.authHeader=Object(et.a)({username:e.meta.arg.username,password:e.meta.arg.password})})),t.addCase(rt.rejected,(function(t,e){console.log(e),t.gettingUserInfo=!1,t.userInfo=void 0,t.userInfoError=e.error?new Error(e.error.message):void 0})),t.addCase(it.pending,(function(t){t.updatingAppointment=!0})),t.addCase(it.fulfilled,(function(t,e){var n;t.updatingAppointment=!1,t.appointments=null===(n=t.appointments)||void 0===n?void 0:n.map((function(t){return t.appointmentId===e.payload.appointmentId?e.payload:t})),t.updatingAppointmentError=void 0})),t.addCase(it.rejected,(function(t,e){console.log(e),t.updatingAppointment=!1,t.updatingAppointmentError=e.error?new Error(e.error.message):void 0}))}}),at=ot.actions,st=at.resetLoginError,ct=at.setStaffAppointments,pt=at.setAppointmentsError,ut=at.resetUpdatingError,lt=at.logout,dt=ot.reducer;function ft(t){Object(s.a)(t);var e=b((function(t){return t.staff})),n=e.authHeader,i=e.userInfo,o=e.userInfoError,a=e.updatingAppointment,c=e.updatingAppointmentError,u=e.appointments,l=e.appointmentsError,f=Object(d.b)();var j=function(t){return function(e){f(it({appointmentId:e,status:t}))}};function g(t){f(ct(t))}function m(t){f(pt(t))}var h=null;return Object(r.useEffect)((function(){return i&&n&&(h=z(n,g,m)),function(){h&&h.close()}}),[i]),Object(G.jsxs)(G.Fragment,{children:[!n&&Object(G.jsx)(_,{onSubmit:function(t){f(rt(t))},loginError:o,closeLoginError:function(){f(st())}}),!!n&&Object(G.jsxs)(p.a,{span:24,children:[Object(G.jsx)(p.a,{span:24,children:i&&Object(G.jsx)(tt,{userInfo:i,logout:function(){f(lt())}})}),i&&Object(G.jsx)(K,{userInfo:i,appointments:u,appointmentsError:l,startAppointment:j("STARTED"),endAppointment:j("FINISHED"),cancelAppointment:j("CANCELLED"),updating:a,updatingError:c,closeUpdatingError:function(){f(ut())}})]})]})}var jt=n(112);function gt(t){Object(s.a)(t);var e=b((function(t){return t})),n=e.mainPanel.customerMode,r=e.customer.appointmentInfo,i=e.staff.userInfo,o=Object(d.b)();return Object(G.jsxs)(c.a,{children:[Object(G.jsx)(jt.Header,{}),Object(G.jsxs)(jt.Content,{style:{minHeight:"30rem",paddingTop:"1rem"},children:[Object(G.jsx)(p.a,{span:24,offset:18,children:!r&&!i&&Object(G.jsx)(u.a,{onClick:function(){o(g())},children:n?"Darbuotojams":"Gr\u012f\u017eti"})}),Object(G.jsxs)(l.a,{justify:"center",align:"middle",children:[!n&&Object(G.jsx)(ft,{}),n&&Object(G.jsx)(W,{})]})]}),Object(G.jsx)(jt.Footer,{children:"Serve-On-Spot App, 2021"})]})}var mt=n(173),bt=Object(f.a)({reducer:{mainPanel:m,customer:L,staff:dt},middleware:function(t){return t({serializableCheck:!1})}});var ht=function(){return Object(G.jsx)("div",{className:"App",children:Object(G.jsx)(mt.ErrorBoundary,{FallbackComponent:function(){return Object(G.jsx)("p",{children:"whoops"})},children:Object(G.jsx)(d.a,{store:bt,children:Object(G.jsx)(gt,{})})})})},Ot=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,347)).then((function(e){var n=e.getCLS,r=e.getFID,i=e.getFCP,o=e.getLCP,a=e.getTTFB;n(t),r(t),i(t),o(t),a(t)}))};a.a.render(Object(G.jsx)(i.a.StrictMode,{children:Object(G.jsx)(ht,{})}),document.getElementById("root")),Ot()}},[[338,1,2]]]);
//# sourceMappingURL=main.2fc5c7c9.chunk.js.map